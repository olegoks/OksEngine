Рассмотрим пример с двумя потоками, где в одном происходит инициализация глобальной переменной, а в другом — чтение и использование этой переменной.
![[Pasted image 20240603195500.png]]
Без использования барьеров памяти данный код будет работать некоректно из-за возможного [[Изменение порядка инструкций|изменения порядка инструкций]]: запись результата в `g_p` может быть выполнена до окончательной инициализации объекта `Widget`, в итоге `Thread 1` будет работать с некорректным объектом.

#### Типы барьеров
Барьеры бывают:
* Однонаправленные
* Двунаправленные